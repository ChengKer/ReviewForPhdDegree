## 第九章 关系查询处理与查询优化

1. RDBMS查询处理阶段：`查询分析`→`查询检查`→`查询优化` →`查询执行`
2. 等值连接/自然连接最常用的实现算法
   - 嵌套循环法(前面记过了)：选择较小的表做外表
   - 排序-合并法(同上)适用于2个表都已经按照连接属性排序
   - 索引连接法(同上)适用于如果一个表在连接属性上有索引
   - Hash Join方法（如果上面2个规则都不适用，其中一个表较小）：将R和S的连接属性作为hash码，用共同的hash函数将两张表中的元组散列到同一个hash文件中
     - 划分阶段：选择小表，将其元组按hash函数分散到hash表的桶中
     - 试探阶段：对另一张表进行一边处理，将其元组散列到适当的hash桶中，并将元组与桶中所有来自于小表并与之相匹配的元组连接起来。该阶段也称为连接阶段。
     - 算法前提：假设两个表中较小的表在第一阶段后可以完全放入内存的hash桶中
3. 查询优化典型的启发式规则：
   - 选择运算应尽可能先做。在优化策略中这是最重要、最基本的一条，**减少中间关系**，降低IO代价
   - 在执行连接前对关系适当地预处理（建立索引，排序）
   - 把**投影和选择**运算同时进行：若有若干投影和选择运算，并且它们都对同一个关系操作，则可以在扫描此关系的同时完成所有的这些运算避免重复扫描关系
   - 尽可能将笛卡尔积转换为连接运算
   - 把投影同其前后的双目运算结合起来，减少扫描关系的遍数
   - 找出公共子表达式
4. 将选择和投影尽可能移动到查询树的叶端

